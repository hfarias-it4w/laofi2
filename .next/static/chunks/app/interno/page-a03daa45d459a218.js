(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6900],{4436:(e,t,s)=>{"use strict";s.d(t,{k5:()=>d});var r=s(2115),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=r.createContext&&r.createContext(a),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach(function(t){var r,a,n;r=e,a=t,n=s[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in r?Object.defineProperty(r,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function d(e){return t=>r.createElement(m,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,s)=>r.createElement(t.tag,c({key:s},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var s,{attr:a,size:n,title:o}=e,d=function(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,l),m=n||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),r.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:s,style:c(c({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),o&&r.createElement("title",null,o),e.children)};return void 0!==n?r.createElement(n.Consumer,null,e=>t(e)):t(a)}},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},7875:(e,t,s)=>{Promise.resolve().then(s.bind(s,9326))},9326:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),a=s(2115),n=s(2108),l=s(5695),i=s(5305),o=s(9911);function c(){let{data:e,status:t}=(0,n.useSession)(),s=null==e?void 0:e.user,c=(null==s?void 0:s.role)==="admin",d=(0,l.useRouter)(),[m,u]=(0,a.useState)([]),[p,x]=(0,a.useState)([]),[h,b]=(0,a.useState)(1),[j,f]=(0,a.useState)(!1),[g,y]=(0,a.useState)(null),[N,v]=(0,a.useState)({name:"",price:"",description:"",image:""}),[w,O]=(0,a.useState)(!1);(0,a.useEffect)(()=>{"loading"!==t&&s&&c&&(fetch("/api/productos").then(e=>e.json()).then(u),fetch("/api/pedidos").then(e=>e.json()).then(x))},[s,c,t]);let P=async e=>{e.preventDefault(),O(!0);try{let e={name:N.name,price:parseFloat(N.price),description:N.description||void 0,image:N.image||void 0},t=!!g,s=t?"/api/productos/".concat(g._id):"/api/productos",r=await fetch(s,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){let e=await r.json();t?u(t=>t.map(t=>t._id===e._id?e:t)):u(t=>[e,...t]),C()}else{let e=await r.json();alert(e.message||"Error al guardar producto")}}catch(e){alert("Error de red")}O(!1)},C=()=>{f(!1),y(null),v({name:"",price:"",description:"",image:""})},k=async e=>{await fetch("/api/pedidos",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e,estado:"entregado"})}),x(t=>t.map(t=>t._id===e?{...t,estado:"entregado"}:t))},S=Math.ceil(p.length/10),E=p.slice((h-1)*10,10*h);return"loading"===t?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#13B29F]"})}):s&&c?(0,r.jsxs)("div",{className:"max-w-5xl mx-auto p-4 space-y-8",children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold text-[#13B29F] flex items-center gap-2",children:[(0,r.jsx)(o.sFP,{})," [INTERNO] Panel de Operaciones"]}),(0,r.jsxs)("section",{className:"bg-white rounded-xl shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-neutral-800",children:"Tipos de Cafe"}),(0,r.jsxs)("button",{onClick:()=>f(!0),className:"flex items-center gap-2 bg-[#13B29F] hover:bg-[#119e8d] text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:[(0,r.jsx)(o.OiG,{})," Agregar"]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b text-left text-neutral-500",children:[(0,r.jsx)("th",{className:"py-2",children:"Nombre"}),(0,r.jsx)("th",{className:"py-2",children:"Precio"}),(0,r.jsx)("th",{className:"py-2",children:"Descripcion"})]})}),(0,r.jsxs)("tbody",{children:[0===m.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,className:"py-4 text-center text-neutral-400",children:"No hay productos"})}),m.map(e=>(0,r.jsxs)("tr",{className:"border-b hover:bg-neutral-50 cursor-pointer",onClick:()=>{y(e),v({name:e.name,price:e.price.toString(),description:e.description||"",image:e.image||""}),f(!0)},children:[(0,r.jsx)("td",{className:"py-2 font-medium",children:e.name}),(0,r.jsxs)("td",{className:"py-2",children:["$",e.price]}),(0,r.jsx)("td",{className:"py-2 text-neutral-500",children:e.description||"-"})]},e._id))]})]})})]}),(0,r.jsxs)("section",{className:"bg-white rounded-xl shadow p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-neutral-800 mb-4",children:"Pedidos Recientes"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b text-left text-neutral-500",children:[(0,r.jsx)("th",{className:"py-2",children:"Usuario"}),(0,r.jsx)("th",{className:"py-2",children:"Productos"}),(0,r.jsx)("th",{className:"py-2",children:"Total"}),(0,r.jsx)("th",{className:"py-2",children:"Estado"}),(0,r.jsx)("th",{className:"py-2",children:"Acciones"})]})}),(0,r.jsxs)("tbody",{children:[0===E.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"py-4 text-center text-neutral-400",children:"No hay pedidos"})}),E.map(e=>{var t,s;let a="bg-gray-100 text-gray-600";return"pendiente"===e.estado?a="bg-yellow-100 text-yellow-800":"preparado"===e.estado?a="bg-green-100 text-green-800":"entregado"===e.estado?a="bg-blue-100 text-blue-800":"cancelado"===e.estado&&(a="bg-red-100 text-red-700"),(0,r.jsxs)("tr",{className:"border-b hover:bg-neutral-50",children:[(0,r.jsx)("td",{className:"py-2",children:(null==(t=e.user)?void 0:t.name)||(null==(s=e.user)?void 0:s.email)||"-"}),(0,r.jsx)("td",{className:"py-2",children:e.productos.map(e=>"".concat(e.cantidad,"x ").concat(e.nombre)).join(", ")}),(0,r.jsxs)("td",{className:"py-2 font-medium",children:["$",e.total]}),(0,r.jsx)("td",{className:"py-2",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(a),children:e.estado.charAt(0).toUpperCase()+e.estado.slice(1)})}),(0,r.jsx)("td",{className:"py-2",children:"entregado"!==e.estado&&"cancelado"!==e.estado&&(0,r.jsxs)("button",{onClick:()=>k(e._id),className:"flex items-center gap-1 text-[#13B29F] hover:text-[#119e8d] font-medium",children:[(0,r.jsx)(o.CMH,{})," Entregar"]})})]},e._id)})]})]})}),S>1&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:()=>b(e=>Math.max(1,e-1)),disabled:1===h,className:"px-3 py-1 rounded border disabled:opacity-50",children:"Anterior"}),(0,r.jsxs)("span",{className:"text-sm text-neutral-600",children:["Pagina ",h," de ",S]}),(0,r.jsx)("button",{onClick:()=>b(e=>Math.min(S,e+1)),disabled:h===S,className:"px-3 py-1 rounded border disabled:opacity-50",children:"Siguiente"})]})]}),j&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:g?"Editar Cafe":"Agregar Cafe"}),(0,r.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nombre *"}),(0,r.jsx)("input",{type:"text",required:!0,value:N.name,onChange:e=>v(t=>({...t,name:e.target.value})),className:"w-full border rounded-lg p-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Precio *"}),(0,r.jsx)("input",{type:"number",step:"0.01",required:!0,value:N.price,onChange:e=>v(t=>({...t,price:e.target.value})),className:"w-full border rounded-lg p-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Descripcion"}),(0,r.jsx)("textarea",{value:N.description,onChange:e=>v(t=>({...t,description:e.target.value})),className:"w-full border rounded-lg p-2",rows:2})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Imagen (URL)"}),(0,r.jsx)("input",{type:"text",value:N.image,onChange:e=>v(t=>({...t,image:e.target.value})),className:"w-full border rounded-lg p-2",placeholder:"https://..."})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{type:"button",onClick:C,className:"px-4 py-2 rounded-lg border",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:w,className:"px-4 py-2 rounded-lg bg-[#13B29F] text-white font-semibold disabled:opacity-50",children:w?"Guardando...":"Guardar"})]})]})]})})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center mt-10",children:[(0,r.jsx)("div",{className:"text-red-600 text-4xl mb-6",children:(0,r.jsx)(i.OrW,{})}),(0,r.jsx)("div",{className:"text-red-600 text-xl mb-6",children:"Acceso denegado"}),(0,r.jsx)("button",{className:"bg-[#13B29F] hover:bg-[#119e8d] text-white rounded-xl py-3 px-6 text-lg font-semibold transition-colors",onClick:()=>d.push("/login"),children:"Ir al login"})]})}}},e=>{e.O(0,[8087,6711,2108,8441,5964,7358],()=>e(e.s=7875)),_N_E=e.O()}]);