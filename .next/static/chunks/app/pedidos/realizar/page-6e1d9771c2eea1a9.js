(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7288],{4436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>d});var a=r(2115),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=a.createContext&&a.createContext(n),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>a.createElement(x,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function x(e){var t=t=>{var r,{attr:n,size:s,title:o}=e,d=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,l),x=s||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:x,width:x,xmlns:"http://www.w3.org/2000/svg"}),o&&a.createElement("title",null,o),e.children)};return void 0!==s?a.createElement(s.Consumer,null,e=>t(e)):t(n)}},5450:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(5155),n=r(6766),s=r(2115),l=r(2108),i=r(9911),o=r(7509);let c=[{value:"mercadopago",label:"Mercado Pago",helper:"Pago online con link seguro",badge:"Link directo",icon:r(3347).p7U},{value:"efectivo",label:"Efectivo",helper:"10% off abonando en recepci\xf3n",badge:"Descuento 10%",icon:i.MxO}],d=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e);function x(){var e;let{data:t}=(0,l.useSession)(),r=(0,s.useRef)(null),[x,u]=(0,s.useState)(""),[m,p]=(0,s.useState)(1),[f,h]=(0,s.useState)("mercadopago"),[b,g]=(0,s.useState)(null),[j,v]=(0,s.useState)([]),[N,w]=(0,s.useState)(!0),[y,O]=(0,s.useState)(!1),[_,P]=(0,s.useState)(null),[C,k]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=!0;return fetch("/api/productos").then(e=>e.json()).then(t=>{e&&v(Array.isArray(t)?t:[])}).catch(()=>v([])).finally(()=>e&&w(!1)),()=>{e=!1}},[]);let S=(0,s.useMemo)(()=>{if(!_)return{precioUnitario:0,precioConDescuento:0,total:0,totalConDescuento:0};let e=_.price,t="efectivo"===f,r=e*m;return{precioUnitario:e,precioConDescuento:t?.9*e:e,total:r,totalConDescuento:t?.9*r:r}},[_,m,f]),E=async e=>{if(e.preventDefault(),!x)return void g("Seleccion\xe1 un producto antes de continuar.");let t=j.find(e=>e._id===x);if(!t)return void g("No encontramos ese producto. Actualiz\xe1 la p\xe1gina e intent\xe1 nuevamente.");let a="efectivo"===f,n=t.price,s=a?.9*n:n,l=[{producto:t._id,nombre:t.name,cantidad:m,precio:Number(s.toFixed(2))}],i=m*s;if("mercadopago"===f){try{let e="".concat(t._id,"-").concat(Date.now()),r=await fetch("/api/mercado-pago/create-preference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productos:l,external_reference:e})}),a=await r.json();if(!r.ok||!a.preference||!a.preference.init_point)return void g(a&&(a.error||a.message||JSON.stringify(a))||"Error al crear preferencia de pago");g(null),window.location.href=a.preference.init_point}catch(e){g("Error al conectar con Mercado Pago: "+(e instanceof Error?e.message:String(e)))}return}let o={productos:l,metodoPago:f,total:i};C.trim()&&(o.comentarios=C.trim());let c=await fetch("/api/pedidos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});c.ok?(p(1),O(!1),k(""),r.current&&(r.current.currentTime=0,r.current.play()),g(null),setTimeout(()=>{window.location.href="pedido-exitoso"},400)):g((await c.json().catch(()=>({}))).message||"No pudimos guardar tu pedido. Intent\xe1 nuevamente en unos segundos.")};return(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-50 text-neutral-900",children:[(0,a.jsx)("audio",{ref:r,src:"/positive-notification.wav",preload:"auto"}),(0,a.jsx)("section",{className:"border-b border-neutral-200 bg-white/70 backdrop-blur",children:(0,a.jsxs)("div",{className:"mx-auto flex max-w-screen-lg flex-col gap-6 px-6 py-12 md:flex-row md:items-center",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-[#fae79a] px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-neutral-900",children:[(0,a.jsx)(o.Hpk,{className:"h-4 w-4"})," Ped\xed tu caf\xe9"]}),(0,a.jsx)("h1",{className:"text-4xl font-black uppercase leading-tight md:text-5xl",children:"Tu caf\xe9 favorito llega directo a tu escritorio"}),(0,a.jsx)("p",{className:"max-w-xl text-neutral-600",children:"Eleg\xed el producto, defin\xed la cantidad y pag\xe1 como prefieras. Cuando confirm\xe1s tu pedido, recepci\xf3n recibe la notificaci\xf3n al instante."}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm text-neutral-600",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-lg bg-white px-3 py-2 shadow-sm",children:[(0,a.jsx)(i.obD,{className:"h-4 w-4 text-[#fdca00]"})," Listo en minutos"]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-lg bg-white px-3 py-2 shadow-sm",children:[(0,a.jsx)(i.MxO,{className:"h-4 w-4 text-[#fdca00]"})," 10% off en efectivo"]})]})]}),(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col gap-3 rounded-2xl border border-neutral-200 bg-white p-6 shadow-[0_1px_2px_rgba(0,0,0,0.06)] md:max-w-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"\xbfC\xf3mo funciona?"}),(0,a.jsxs)("ol",{className:"space-y-3 text-sm text-neutral-600",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"1."})," Eleg\xed tu caf\xe9 preferido."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"2."})," Defin\xed la cantidad y el m\xe9todo de pago."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"3."})," Confirm\xe1 y esper\xe1 la notificaci\xf3n de recepci\xf3n."]})]}),(0,a.jsxs)("button",{type:"button",className:"inline-flex items-center justify-center gap-2 rounded-lg bg-[#fdca00] px-4 py-2 text-sm font-semibold text-neutral-900 shadow-[0_10px_40px_-10px_rgba(253,202,0,0.6)] transition hover:bg-[#f1be00]",onClick:()=>{let e=document.getElementById("productos-listado");null==e||e.scrollIntoView({behavior:"smooth"})},children:["Ver men\xfa",(0,a.jsx)(i.Z0P,{className:"h-4 w-4"})]})]})]})}),(0,a.jsxs)("main",{className:"mx-auto max-w-screen-xl px-6 pb-24",id:"productos-listado",children:[(0,a.jsxs)("header",{className:"flex flex-col gap-2 pt-16 pb-8 text-center",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-neutral-900 md:text-4xl",children:"Seleccion\xe1 tu caf\xe9"}),(0,a.jsx)("p",{className:"mx-auto max-w-2xl text-neutral-600",children:"Nuestros baristas preparan cada bebida con granos reci\xe9n molidos. Pod\xe9s pagar con Mercado Pago o en efectivo con descuento exclusivo para coworkers."})]}),b&&(0,a.jsx)("div",{className:"mx-auto mb-8 max-w-screen-md rounded-lg border border-[#fdca00]/40 bg-[#fff7d1] px-4 py-3 text-sm text-neutral-800",children:b}),N?(0,a.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,a.jsxs)("div",{className:"animate-pulse rounded-2xl border border-neutral-200 bg-white p-6 shadow-[0_1px_2px_rgba(0,0,0,0.06)]",children:[(0,a.jsx)("div",{className:"mb-4 h-40 w-full rounded-xl bg-neutral-100"}),(0,a.jsx)("div",{className:"mb-3 h-4 w-2/3 rounded bg-neutral-200"}),(0,a.jsx)("div",{className:"mb-6 h-4 w-1/2 rounded bg-neutral-200"}),(0,a.jsx)("div",{className:"h-10 w-full rounded-lg bg-neutral-200"})]},t))}):0===j.length?(0,a.jsx)("div",{className:"rounded-2xl border border-dashed border-neutral-300 bg-white p-12 text-center text-neutral-500",children:"A\xfan no hay productos disponibles. Volv\xe9 m\xe1s tarde o avis\xe1 a recepci\xf3n."}):(0,a.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:j.map(e=>{var t;return(0,a.jsxs)("article",{className:"group flex flex-col justify-between rounded-2xl border border-transparent bg-white p-6 shadow-[0_10px_30px_-20px_rgba(0,0,0,0.45)] transition hover:-translate-y-1 hover:border-[#fdca00]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"relative mb-5 overflow-hidden rounded-xl border border-neutral-200 bg-neutral-100",children:e.image?(0,a.jsx)(n.default,{src:e.image,alt:e.name,width:400,height:160,className:"h-40 w-full object-cover transition duration-300 group-hover:scale-105",unoptimized:!0}):(0,a.jsx)("div",{className:"flex h-40 items-center justify-center text-neutral-400",children:(0,a.jsx)(o.Hpk,{className:"h-10 w-10"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:e.name}),(0,a.jsx)("p",{className:"mt-2 text-sm text-neutral-500",children:null!=(t=e.description)?t:"Preparado con nuestros granos seleccionados para que disfrutes cada pausa."})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xl font-bold text-neutral-900",children:d(e.price)}),(0,a.jsxs)("button",{type:"button",className:"inline-flex items-center gap-2 rounded-lg bg-neutral-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-neutral-800",onClick:()=>{P(e),u(e._id),O(!0),p(1),h("mercadopago"),k(""),g(null)},children:["Pedir ahora",(0,a.jsx)(i.Z0P,{className:"h-4 w-4"})]})]})]},e._id)})})]}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-neutral-900/70 px-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-3xl overflow-hidden rounded-3xl border border-neutral-200 bg-white shadow-[0_40px_80px_-40px_rgba(0,0,0,0.45)]",children:[(0,a.jsx)("button",{className:"absolute right-5 top-5 text-2xl text-neutral-400 transition hover:text-neutral-700",onClick:()=>{O(!1),k("")},"aria-label":"Cerrar",children:"\xd7"}),(0,a.jsxs)("div",{className:"grid gap-8 p-8 md:grid-cols-[280px_1fr]",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-5 rounded-2xl bg-neutral-50 p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(null==_?void 0:_.image)?(0,a.jsx)(n.default,{src:_.image,alt:_.name,width:160,height:160,className:"h-40 w-40 rounded-2xl border border-neutral-200 object-cover",unoptimized:!0}):(0,a.jsx)("div",{className:"flex h-40 w-40 items-center justify-center rounded-2xl border border-neutral-200 bg-white text-neutral-400",children:(0,a.jsx)(o.Hpk,{className:"h-10 w-10"})}),(0,a.jsx)("p",{className:"mt-4 text-xs font-semibold uppercase tracking-[0.3em] text-neutral-400",children:"Paso final"}),(0,a.jsx)("h2",{className:"mt-2 text-2xl font-bold text-neutral-900",children:(null==t||null==(e=t.user)?void 0:e.name)?"Hola, ".concat(t.user.name.split(" ")[0],"!"):"Confirm\xe1 tu caf\xe9"}),(0,a.jsxs)("p",{className:"mt-2 max-w-[16rem] text-sm text-neutral-600",children:["Estamos preparando ",(0,a.jsx)("strong",{children:null==_?void 0:_.name}),". Ajust\xe1 los detalles y avisamos a recepci\xf3n."]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 rounded-xl border border-neutral-200 bg-white p-4",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-800",children:"Resumen r\xe1pido"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-neutral-600",children:[(0,a.jsx)("span",{children:"Precio unitario"}),(0,a.jsx)("span",{className:"font-semibold text-neutral-900",children:d(S.precioConDescuento)})]}),"efectivo"===f&&(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-[#b07a00]",children:[(0,a.jsx)("span",{children:"Incluye 10% OFF por efectivo"}),(0,a.jsx)("span",{children:d(S.precioUnitario)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t border-dashed border-neutral-200 pt-3 text-base font-semibold text-neutral-900",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsx)("span",{children:d(S.totalConDescuento)})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:"Recepci\xf3n recibe este resumen y tu nota al instante."})]})]}),(0,a.jsx)("div",{className:"flex flex-col gap-6",children:t?(0,a.jsxs)("form",{onSubmit:E,className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-800",children:"Cantidad"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-neutral-200 bg-neutral-50 p-2",children:[(0,a.jsx)("button",{type:"button",className:"inline-flex h-10 w-10 items-center justify-center rounded-lg bg-white text-neutral-600 transition hover:bg-neutral-100 hover:text-neutral-900",onClick:()=>p(e=>e>1?e-1:1),"aria-label":"Disminuir cantidad",children:(0,a.jsx)(i.iu5,{})}),(0,a.jsx)("div",{className:"flex flex-1 items-center justify-center rounded-lg bg-white px-6 py-2 text-base font-semibold text-neutral-900",children:m}),(0,a.jsx)("button",{type:"button",className:"inline-flex h-10 w-10 items-center justify-center rounded-lg bg-white text-neutral-600 transition hover:bg-neutral-100 hover:text-neutral-900",onClick:()=>p(e=>e+1),"aria-label":"Aumentar cantidad",children:(0,a.jsx)(i.OiG,{})})]})]}),(0,a.jsxs)("fieldset",{className:"flex flex-col gap-3",children:[(0,a.jsx)("legend",{className:"text-sm font-semibold text-neutral-800",children:"M\xe9todo de pago"}),(0,a.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:c.map(e=>{let t=e.icon,r=f===e.value;return(0,a.jsxs)("button",{type:"button",onClick:()=>h(e.value),className:"flex h-full flex-col justify-between rounded-xl border p-4 text-left transition focus:outline-none focus-visible:ring-2 focus-visible:ring-[#fdca00] ".concat(r?"border-[#fdca00] bg-[#fff7d1]":"border-neutral-200 bg-white hover:border-neutral-300"),"aria-pressed":r,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-base font-semibold text-neutral-900",children:e.label}),(0,a.jsx)("span",{className:"rounded-full px-3 py-1 text-xs font-semibold ".concat(r?"bg-neutral-900 text-white":"bg-neutral-100 text-neutral-600"),children:e.badge})]}),(0,a.jsxs)("p",{className:"mt-3 flex items-center gap-2 text-sm text-neutral-600",children:[(0,a.jsx)(t,{className:"h-5 w-5 text-[#fdca00]"}),e.helper]}),(0,a.jsxs)("span",{className:"sr-only",children:["Seleccionar ",e.label]})]},e.value)})})]}),(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm font-semibold text-neutral-800",htmlFor:"nota-pedido",children:["Nota para recepci\xf3n (opcional)",(0,a.jsx)("textarea",{id:"nota-pedido",className:"min-h-[80px] rounded-lg border border-neutral-300 px-4 py-3 text-sm text-neutral-900 placeholder:text-neutral-400 focus:border-[#fdca00] focus:outline-none",placeholder:"Ej: sin az\xfacar, agregar hielo, entregar en sala Norte",value:C,onChange:e=>k(e.target.value),maxLength:200})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 rounded-xl border border-neutral-200 bg-neutral-50 p-4 text-xs text-neutral-500",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-800",children:"Antes de confirmar"}),(0,a.jsx)("p",{children:"Revis\xe1 la cantidad y el m\xe9todo de pago. Si eleg\xeds Mercado Pago te redirigimos al link seguro. Si pag\xe1s en efectivo, abon\xe1s al retirar en recepci\xf3n."})]}),(0,a.jsxs)("button",{className:"inline-flex items-center justify-center gap-2 rounded-lg bg-neutral-900 px-5 py-3 text-base font-semibold text-white transition hover:bg-neutral-800",type:"submit",children:["Confirmar pedido",(0,a.jsx)(i.Z0P,{className:"h-4 w-4"})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Inici\xe1 sesi\xf3n para completar tu pedido."}),(0,a.jsxs)("button",{className:"inline-flex items-center gap-2 rounded-lg bg-[#fdca00] px-6 py-3 text-base font-semibold text-neutral-900 shadow-[0_10px_40px_-10px_rgba(253,202,0,0.6)] transition hover:bg-[#f1be00]",onClick:()=>(0,l.signIn)(),children:["Iniciar sesi\xf3n",(0,a.jsx)(i.Z0P,{className:"h-4 w-4"})]})]})})]}),b&&(0,a.jsx)("div",{className:"border-t border-neutral-200 bg-neutral-50 px-8 py-4 text-center text-sm text-neutral-600",children:b})]})})]})}},6683:(e,t,r)=>{Promise.resolve().then(r.bind(r,5450))}},e=>{e.O(0,[6711,4506,9204,2108,6766,8441,5964,7358],()=>e(e.s=6683)),_N_E=e.O()}]);